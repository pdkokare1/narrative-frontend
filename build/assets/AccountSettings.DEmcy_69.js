import{j as e}from"./vendor-utils.C5aUNQjH.js";import{r as l,u as b}from"./vendor-react.CunEISTA.js";import{P as C,C as r,B as a,g as k,m as u,h as S,s as E,i as P,j as f}from"./index.BE3a_34f.js";import{s as p}from"./vendor-firebase.CapENl2a.js";import{S as A}from"./SectionHeader.Dw_45JcM.js";import"./vendor-ui.DT2d8rn5.js";import"./vendor-charts.CDFCwfjF.js";const Y=({currentFontSize:o,onSetFontSize:d})=>{const[t,j]=l.useState(null),[y,c]=l.useState(!0),[x,g]=l.useState(""),[h,i]=l.useState("default"),m=b();l.useEffect(()=>{(async()=>{g(""),c(!0);try{const{data:s}=await k();j(s),s.notificationsEnabled&&Notification.permission==="granted"?i("granted"):Notification.permission==="denied"&&i("denied")}catch(s){console.error("Error fetching profile:",s),g("Could not load your profile data. Please try again later.")}finally{c(!1)}})()},[]);const N=async()=>{if(!u){alert("Notifications are not supported on this browser.");return}i("loading");try{if(await Notification.requestPermission()==="granted"){const s=await S(u,{vapidKey:void 0});s?(await E(s),i("granted"),alert("Success! You will now receive daily briefings.")):(console.warn("No registration token available."),i("default"))}else i("denied"),alert("Permission denied. You can enable them in your browser settings.")}catch(n){console.error("Notification Error:",n),i("default")}},v=async()=>{if(window.confirm("Are you sure? This will permanently delete your stats, saved articles, and profile."))try{c(!0),await P(),await p(f),alert("Account deleted."),m("/")}catch(s){console.error("Delete Account Error:",s),alert("Failed to delete account."),c(!1)}},w=async()=>{try{await p(f),m("/")}catch(n){console.error("Sign Out Error:",n)}};return y&&!t?e.jsx(C,{}):e.jsx("div",{className:"content",children:e.jsxs("div",{className:"settings-container",children:[e.jsx(A,{title:"Account Settings",subtitle:"Manage your preferences and data",align:"center"}),x&&e.jsxs(r,{className:"settings-card error-card",children:[e.jsx("p",{style:{color:"var(--color-error)",marginBottom:"15px"},children:x}),e.jsx(a,{onClick:()=>window.location.reload(),variant:"secondary",children:"Retry"})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"settings-card",children:[e.jsxs("div",{className:"settings-field",children:[e.jsx("span",{className:"settings-label",children:"Username"}),e.jsx("p",{className:"settings-value",children:t.username})]}),e.jsxs("div",{className:"settings-field",children:[e.jsx("span",{className:"settings-label",children:"Email"}),e.jsx("p",{className:"settings-value",children:t.email})]}),e.jsx("hr",{className:"settings-divider"}),e.jsx("h2",{className:"settings-section-title",children:"Your Progress"}),e.jsxs("div",{className:"stat-row",children:[e.jsx("strong",{children:"Daily Streak"}),e.jsxs("span",{className:"accent-text",children:[t.currentStreak||0," Days ðŸ”¥"]})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("strong",{children:"Articles Analyzed"}),e.jsx("span",{children:t.articlesViewedCount||0})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("strong",{children:"Comparisons Viewed"}),e.jsx("span",{children:t.comparisonsViewedCount||0})]})]}),e.jsxs(r,{className:"settings-card mt-20",children:[e.jsx("h2",{className:"settings-section-title",children:"Appearance"}),e.jsxs("div",{className:"settings-field",children:[e.jsx("span",{className:"settings-label",style:{marginBottom:"10px",display:"block"},children:"Text Size"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx(a,{variant:o==="medium"?"primary":"secondary",onClick:()=>d("medium"),style:{flex:1},children:"Normal"}),e.jsx(a,{variant:o==="large"?"primary":"secondary",onClick:()=>d("large"),style:{flex:1,fontSize:"12px"},children:"Large"}),e.jsx(a,{variant:o==="xl"?"primary":"secondary",onClick:()=>d("xl"),style:{flex:1,fontSize:"13px"},children:"Extra"})]})]})]}),e.jsxs(r,{className:"settings-card mt-20",children:[e.jsx("h2",{className:"settings-section-title",children:"Notifications"}),e.jsx("div",{className:"settings-field",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"settings-label",children:"Daily Briefing"}),e.jsx("p",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:"Get a morning summary."})]}),h==="granted"?e.jsx(a,{variant:"secondary",disabled:!0,style:{color:"var(--color-success)",borderColor:"var(--color-success)"},children:"Enabled âœ“"}):e.jsx(a,{variant:"primary",onClick:N,isLoading:h==="loading",children:"Enable"})]})})]}),e.jsxs(r,{className:"settings-card mt-20",children:[e.jsx("h2",{className:"settings-section-title",children:"Legal"}),e.jsx("div",{className:"settings-field",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"settings-label",children:"Privacy & Terms"}),e.jsx("p",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:"Read our policies."})]}),e.jsx(a,{variant:"secondary",onClick:()=>m("/legal"),children:"View"})]})})]}),e.jsxs(r,{className:"settings-card danger-card mt-30",children:[e.jsx("h2",{className:"settings-section-title danger-title",children:"Danger Zone"}),e.jsx("p",{className:"danger-text",children:"Permanently delete your account and all data."}),e.jsx(a,{onClick:v,variant:"secondary",className:"btn-danger-custom",children:"Delete Account"})]}),e.jsx("div",{style:{marginTop:"40px",marginBottom:"60px"},children:e.jsx(a,{variant:"secondary",onClick:w,className:"btn-signout-custom",children:"Sign Out"})})]})]})})};export{Y as default};
