import{g as D,h as L,i as T,k as q,l as R,m as P,n as W,o as B,s as F,p as H,q as N,r as b,t as _,v as E,w as Q,x as z,y as Y,z as V,A as $,B as K,C as G,D as J,E as U,F as X,G as Z,H as ee,I as re,J as se,K as ae,L as te,M as ne,N as ie,O as oe,P as le,f as I,R as ce,S as de,T as ue,U as he,e as fe,j as r}from"./vendor-utils.C5aUNQjH.js";import{r as C,b as xe}from"./vendor-react.CunEISTA.js";import{h as ye,e as pe,C as ge,a as je,L as me,P as be,b as Ce,p as ve,c as Me,d as Ie,T as Oe}from"./vendor-charts.CDFCwfjF.js";import{q as we}from"./index.BE3a_34f.js";import{u as Se,D as ke,l as Ae,B as o,T as l,I as v,m as De,n as Le,o as Te,p as qe,q as Re,r as M,A as Pe,s as We,t as y,v as Be,w as Fe,x as He,y as Ne,z as _e}from"./vendor-ui.DT2d8rn5.js";import"./vendor-firebase.CapENl2a.js";/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const Ee={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};ye._date.override({_id:"date-fns",formats:function(){return Ee},parse:function(e,s){if(e===null||typeof e>"u")return null;const t=typeof e;return t==="number"||e instanceof Date?e=ce(e):t==="string"&&(typeof s=="string"?e=de(e,s,new Date,this.options):e=ue(e,this.options)),he(e)?e.getTime():null},format:function(e,s){return I(e,s,this.options)},add:function(e,s,t){switch(t){case"millisecond":return le(e,s);case"second":return oe(e,s);case"minute":return ie(e,s);case"hour":return ne(e,s);case"day":return te(e,s);case"week":return ae(e,s);case"month":return se(e,s);case"quarter":return re(e,s);case"year":return ee(e,s);default:return e}},diff:function(e,s,t){switch(t){case"millisecond":return Z(e,s);case"second":return X(e,s);case"minute":return U(e,s);case"hour":return J(e,s);case"day":return G(e,s);case"week":return K(e,s);case"month":return $(e,s);case"quarter":return V(e,s);case"year":return Y(e,s);default:return 0}},startOf:function(e,s,t){switch(s){case"second":return z(e);case"minute":return Q(e);case"hour":return E(e);case"day":return _(e);case"week":return b(e);case"isoWeek":return b(e,{weekStartsOn:+t});case"month":return N(e);case"quarter":return H(e);case"year":return F(e);default:return e}},endOf:function(e,s){switch(s){case"second":return B(e);case"minute":return W(e);case"hour":return P(e);case"day":return R(e);case"week":return q(e);case"month":return T(e);case"quarter":return L(e);case"year":return D(e);default:return e}}});ge.register(je,me,be,Ce,ve,Me,Ie,Oe);function p(e){const{children:s,value:t,index:c,...d}=e;return r.jsx("div",{role:"tabpanel",hidden:t!==c,id:`coverage-tabpanel-${c}`,"aria-labelledby":`coverage-tab-${c}`,...d,children:t===c&&r.jsx(o,{sx:{p:2},children:s})})}const Ge=({open:e,onClose:s,articleId:t,articleTitle:c})=>{const d=Se(),[u,O]=C.useState(0),{data:i,isLoading:w,error:S}=fe({queryKey:["coverage",t],queryFn:()=>we(t),enabled:e&&!!t}),k=(a,n)=>{O(n)},g=C.useMemo(()=>!(i!=null&&i.timeline)||i.timeline.length===0?null:{datasets:[{label:"Coverage Sentiment",data:i.timeline.map(a=>({x:new Date(a.publishedAt),y:a.sentimentScore})),borderColor:d.palette.primary.main,backgroundColor:d.palette.primary.light,pointRadius:4,pointHoverRadius:6,tension:.3}]},[i,d]),A={responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"MMM d"}},grid:{display:!1}},y:{min:-1,max:1,grid:{color:d.palette.divider},ticks:{callback:a=>a===1?"Positive":a===-1?"Negative":a===0?"Neutral":""}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:a=>{const n=a.parsed.y;return n!==null?`Sentiment: ${n.toFixed(2)}`:""}}}}},f=a=>i!=null&&i.articles?a==="all"?i.articles:i.articles.filter(n=>{var h;return((h=n.bias)==null?void 0:h.toLowerCase())===a.toLowerCase()}):[],x=a=>a.length===0?r.jsx(o,{sx:{textAlign:"center",py:4,color:"text.secondary"},children:r.jsx(l,{variant:"body1",children:"No articles found for this category."})}):r.jsx(Be,{children:a.map((n,h)=>{var j,m;return r.jsxs(xe.Fragment,{children:[r.jsx(Fe,{alignItems:"flex-start",secondaryAction:r.jsx(v,{edge:"end",href:n.url,target:"_blank",children:r.jsx(_e,{})}),children:r.jsx(He,{primary:n.title,secondary:r.jsxs(o,{component:"span",sx:{display:"flex",gap:1,mt:.5,alignItems:"center"},children:[r.jsx(l,{component:"span",variant:"caption",color:"text.secondary",children:n.source}),r.jsxs(l,{component:"span",variant:"caption",color:"text.secondary",children:["â€¢ ",I(new Date(n.publishedAt),"MMM d, yyyy")]}),r.jsx(Ne,{label:n.bias,size:"small",color:((j=n.bias)==null?void 0:j.toLowerCase())==="left"?"primary":((m=n.bias)==null?void 0:m.toLowerCase())==="right"?"error":"default",sx:{height:20,fontSize:"0.7rem"}})]})})}),h<a.length-1&&r.jsx(M,{component:"li"})]},n.id||h)})});return r.jsxs(ke,{open:e,onClose:s,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2,minHeight:"60vh"}},children:[r.jsxs(Ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs(o,{children:[r.jsx(l,{variant:"h6",children:"Coverage Analysis"}),c&&r.jsx(l,{variant:"subtitle2",color:"text.secondary",noWrap:!0,sx:{maxWidth:400},children:c})]}),r.jsx(v,{onClick:s,children:r.jsx(De,{})})]}),r.jsx(Le,{dividers:!0,children:w?r.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:r.jsx(Te,{})}):S?r.jsxs(o,{sx:{textAlign:"center",py:4},children:[r.jsx(l,{color:"error",children:"Failed to load coverage data."}),r.jsx(qe,{onClick:()=>window.location.reload(),sx:{mt:2},children:"Retry"})]}):!i||!i.timeline&&!i.articles?r.jsx(o,{sx:{textAlign:"center",py:4},children:r.jsx(l,{variant:"body1",color:"text.secondary",children:"No coverage data available for this topic yet."})}):r.jsxs(r.Fragment,{children:[r.jsxs(o,{sx:{mb:4,height:250},children:[r.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[r.jsx(Re,{color:"action",sx:{mr:1}}),r.jsx(l,{variant:"subtitle1",children:"Coverage Timeline"})]}),g?r.jsx(pe,{data:g,options:A}):r.jsx(o,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"action.hover",borderRadius:1},children:r.jsx(l,{variant:"body2",color:"text.secondary",children:"Not enough data for timeline"})})]}),r.jsx(M,{sx:{my:2}}),r.jsxs(o,{children:[r.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[r.jsx(Pe,{color:"action",sx:{mr:1}}),r.jsx(l,{variant:"subtitle1",children:"Sources by Bias"})]}),r.jsxs(We,{value:u,onChange:k,variant:"fullWidth",textColor:"primary",indicatorColor:"primary",children:[r.jsx(y,{label:"All"}),r.jsx(y,{label:"Left"}),r.jsx(y,{label:"Center"}),r.jsx(y,{label:"Right"})]}),r.jsx(p,{value:u,index:0,children:x(f("all"))}),r.jsx(p,{value:u,index:1,children:x(f("left"))}),r.jsx(p,{value:u,index:2,children:x(f("center"))}),r.jsx(p,{value:u,index:3,children:x(f("right"))})]})]})})]})};export{Ge as default};
