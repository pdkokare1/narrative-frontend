import{u as T,e as k,j as e}from"./vendor-utils.C5aUNQjH.js";import{r as E,L as _}from"./vendor-react.CunEISTA.js";import{a as B,b as R,d as q,e as I,S as j,A as g,B as S,o as i,f as Q}from"./index.BE3a_34f.js";import{S as w}from"./SectionHeader.Dw_45JcM.js";import"./vendor-firebase.CapENl2a.js";import"./vendor-ui.DT2d8rn5.js";import"./vendor-charts.CDFCwfjF.js";const K=({onToggleSave:b,onCompare:o,onAnalyze:c,onRead:d,showTooltip:h})=>{const A=B(),{addToast:N}=R(),{handleShare:m}=q(),{updateContextQueue:p}=I(),C=T(),{data:s=[],isLoading:f,error:u}=k({queryKey:["savedArticles"],queryFn:async()=>{try{const{data:r}=await Q(),a=r.articles||[];return a.length>0&&i.save("saved-library",a),a}catch(r){console.warn("Network failed, attempting offline load:",r);const a=await i.get("saved-library");if(a&&Array.isArray(a))return N("Offline mode: Showing cached library","info"),await Promise.all(a.map(async t=>{const l=await i.getOfflineArticle(t._id);return l&&l.offlineImageBlob?{...t,imageUrl:URL.createObjectURL(l.offlineImageBlob)}:t}));throw r}},staleTime:1e3*60*5});E.useEffect(()=>{s.length>0&&p(s,"Saved Library")},[s,p]);const v=r=>{b(r),C.setQueryData(["savedArticles"],a=>{if(!a)return[];const n=a.filter(t=>t._id!==r._id);return i.save("saved-library",n),n})},x=()=>e.jsxs("div",{className:"saved-placeholder",children:[e.jsx("h2",{children:"No Saved Articles"}),e.jsx("p",{children:"Articles you save will appear here for quick access."}),e.jsx(_,{to:"/",style:{marginTop:"20px",textDecoration:"none"},children:e.jsx(S,{variant:"secondary",children:"Browse Articles"})})]}),y=()=>e.jsxs("div",{className:"saved-placeholder",children:[e.jsx("h2",{className:"error-text",children:"Connection Error"}),e.jsx("p",{children:"Could not load your library and no offline copy was found."}),e.jsx(S,{onClick:()=>window.location.reload(),variant:"primary",style:{marginTop:"20px"},children:"Retry"})]}),L=()=>e.jsx("div",{className:"articles-grid",children:[...Array(6)].map((r,a)=>e.jsx("div",{className:"article-card-wrapper",children:e.jsx(j,{})},a))});return A?e.jsxs("main",{className:"content",children:[e.jsx(w,{title:"Saved Articles",subtitle:`${s.length} Items`}),f?e.jsx("div",{className:"article-card-wrapper",children:e.jsx(j,{})}):u?e.jsx("div",{className:"article-card-wrapper",children:y()}):s.length===0?e.jsx("div",{className:"article-card-wrapper",children:x()}):e.jsx(e.Fragment,{children:s.map(r=>e.jsx("div",{className:"article-card-wrapper",children:e.jsx(g,{article:r,onCompare:()=>o(r),onAnalyze:c,onShare:()=>m(r),onRead:d,showTooltip:h,isSaved:!0,onToggleSave:()=>v(r)})},r._id))})]}):e.jsx("div",{className:"content saved-articles-container",children:f?L():u?y():e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Saved Library",subtitle:`${s.length} saved for later reading`}),s.length===0?x():e.jsx("div",{className:"articles-grid",children:s.map(r=>e.jsx(g,{article:r,onCompare:()=>o(r),onAnalyze:c,onShare:()=>m(r),onRead:d,showTooltip:h,isSaved:!0,onToggleSave:()=>v(r)},r._id))})]})})};export{K as default};
